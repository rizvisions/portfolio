<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>RIZVISIONS</title>
  <style>
    html, body { width: 100%; overflow-x: hidden; }

    body {
      font-family: Arial, sans-serif;
      color: black;
      background-color: white;
      margin: 0;
      padding: 0;
    }

    .announcement-container {
      border-bottom: 1px solid black;
      overflow: hidden;
      position: relative;
      background: white;
      max-width: 100%;
      box-sizing: border-box;
    }

    .announcement {
      display: inline-block;
      white-space: nowrap;
      animation: marquee 75s linear infinite;
    }

    @keyframes marquee {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    .announcement a {
      color: black;
      text-decoration: none;
      margin: 0;
    }

    .announcement a:hover { text-decoration: underline; }

    .announcement .sep {
      padding: 0 0.8rem;
      opacity: 0.6;
    }

    header {
      padding: 20px;
      text-align: center;
      background: white;
      margin-bottom: 0;
    }

    h1 {
      font-size: 50px;
      text-transform: uppercase;
      margin-top: 30px;
      margin-bottom: -10px;
    }

    .time-location {
      text-align: center;
      margin: 0 auto 40px auto;
      white-space: nowrap;
    }

    nav {
      background-color: black;
      text-align: center;
      padding: 5px;
      max-width: 100%;
      box-sizing: border-box;
    }

    nav a {
      margin: 0 15px;
      text-decoration: none;
      color: white;
    }

    .container {
      max-width: 100%;
      margin: auto;
      text-align: center;
      box-sizing: border-box;
    }

    .greeting {
      font-size: 125px;
      font-weight: bold;
      text-align: center;
      margin-top: 150px;
      overflow: hidden;
      text-overflow: clip;
    }

    .sub-greeting {
      font-size: 24px;
      color: black;
      text-align: center;
      margin-top: 20px;
    }

    .page-section { display: none; }
    .page-section.active { display: block; }
    .hidden { display: none; }

    body.darkmode--activated .announcement {
      background-color: #333;
      color: white;
    }

    body.darkmode--activated .announcement a { color: white; }

    .darkmode-toggle { position: relative; }

    .darkmode-toggle::before {
      content: '\1F319';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 0.8em;
      color: white;
    }

    /* Mobile tweaks */
    @media (max-width: 480px) {
      nav { padding: 8px; }
      .announcement .sep { padding: 0 0.5rem; }
      .greeting { font-size: 18vw; }
      h1 { font-size: clamp(34px, 12vw, 50px); } /* mobile bump without overshoot */
    }
  </style>
</head>

<body>
  <div class="announcement-container">
    <div class="announcement" id="news-headline">Loading latest business news...</div>
  </div>

  <header>
    <h1 id="site-title">RIZVISIONS</h1>
  </header>

  <div class="time-location" id="time-location">
    <span id="time"></span> | <span id="location"></span>
  </div>

  <nav>
    <a href="#home">Home</a>
    <a href="#about">About</a>
    <a href="#contact">Contact</a>
  </nav>

  <div class="container">
    <div id="home-section" class="page-section active">
      <div class="greeting" id="greeting-text">GOOD MORNING</div>
      <div class="sub-greeting" id="sub-greeting-text"></div>
    </div>

    <div id="about-section" class="page-section">
      <h2>About</h2>
      <p>Trying things until one of them changes everything.</p>
    </div>

    <div id="contact-section" class="page-section">
      <h2>Come Say Hi</h2>
      <p>
        <a href="https://www.instagram.com/rizvisions/" target="_blank">Instagram</a> ·
        <a href="https://x.com/rizvisions" target="_blank">X</a> ·
        <a href="https://www.linkedin.com/in/riz-zaheer/" target="_blank">LinkedIn</a> ·
        <a href="https://www.tiktok.com/@riz.com" target="_blank">TikTok</a> ·
        <a href="https://www.youtube.com/@rizzaheer/videos" target="_blank">YouTube</a>
      </p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
  <script>
    function addDarkmodeWidget() { new Darkmode().showWidget(); }
    window.addEventListener('load', addDarkmodeWidget);

    async function fetchNews() {
      const container = document.querySelector('.announcement-container');
      const GNEWS_BUSINESS = 'https://news.google.com/rss/headlines/section/topic/BUSINESS?hl=en-US&gl=US&ceid=US:en';
      const GNEWS_TECH = 'https://news.google.com/rss/headlines/section/topic/TECHNOLOGY?hl=en-US&gl=US&ceid=US:en';
      const RSS2JSON = rss => 'https://api.rss2json.com/v1/api.json?rss_url=' + encodeURIComponent(rss);

      function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }

      function renderLinks(pairs) {
        const once = pairs.map(([title, link]) =>
          `<a href="${link}" target="_blank" rel="noopener">${title}</a><span class="sep" aria-hidden="true">|</span>`
        ).join('');
        const doubled = once + once;
        container.innerHTML = `<div class="announcement">${doubled}</div>`;
      }

      try {
        const [rBiz, rTech] = await Promise.all([
          fetch(RSS2JSON(GNEWS_BUSINESS), { cache: 'no-store' }),
          fetch(RSS2JSON(GNEWS_TECH), { cache: 'no-store' })
        ]);

        const [jBiz, jTech] = await Promise.all([rBiz.json(), rTech.json()]);
        const items = [...(jBiz.items || []), ...(jTech.items || [])];

        const seen = new Set();
        const pairs = [];
        for (const it of items) {
          const title = (it.title || 'Untitled').trim();
          const key = title.toLowerCase();
          if (seen.has(key)) continue;
          seen.add(key);
          pairs.push([title, it.link || '#']);
        }

        renderLinks(shuffle(pairs).slice(0, 40));
        return;
      } catch {
        renderLinks([['Unable to load live news — retry later', '#']]);
      }
    }

    window.addEventListener('DOMContentLoaded', fetchNews);
    setInterval(fetchNews, 600000);

    function fitGreeting() {
      const g = document.getElementById('greeting-text');
      if (!g) return;
      g.style.fontSize = '';
      const container = document.querySelector('.container');
      const paddingLeft = parseFloat(getComputedStyle(container).paddingLeft) || 0;
      const paddingRight = parseFloat(getComputedStyle(container).paddingRight) || 0;
      const safety = 2;
      const containerWidth = Math.max(0, (window.innerWidth - paddingLeft - paddingRight - safety));
      let tries = 3;
      while (g.scrollWidth > containerWidth && tries-- > 0) {
        const current = parseFloat(getComputedStyle(g).fontSize);
        const ratio = containerWidth / g.scrollWidth;
        g.style.fontSize = (current * ratio * 0.985) + 'px';
      }
    }

    function syncTimeWidth() {
      const siteTitle = document.getElementById('site-title');
      const timeLoc = document.getElementById('time-location');
      timeLoc.style.width = siteTitle.offsetWidth + 'px';
    }

    function updateTime() {
      const now = new Date();
      const hours = now.getHours();
      document.getElementById('time').textContent = now.toLocaleTimeString();
      const greetingText = document.getElementById('greeting-text');
      if (hours >= 6 && hours < 12) {
        greetingText.textContent = "GOOD MORNING";
      } else if (hours >= 12 && hours < 18) {
        greetingText.textContent = "GOOD AFTERNOON";
      } else if (hours >= 18 && hours < 24) {
        greetingText.textContent = "GOOD EVENING";
      } else {
        greetingText.textContent = "GO TO SLEEP";
      }
      fitGreeting();
      syncTimeWidth();
    }

    setInterval(updateTime, 1000);
    updateTime();

    if ('geolocation' in navigator) {
      navigator.geolocation.getCurrentPosition(position => {
        const lat = position.coords.latitude.toFixed(2);
        const lon = position.coords.longitude.toFixed(2);
        document.getElementById('location').textContent = `Lat: ${lat}, Long: ${lon}`;
      }, () => {
        document.getElementById('location').textContent = 'Location not available';
      });
    } else {
      document.getElementById('location').textContent = 'Location not available';
    }

    document.querySelector('nav').addEventListener('click', event => {
      if (event.target.tagName === 'A') {
        document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
        const sectionId = event.target.getAttribute('href').substring(1) + '-section';
        document.getElementById(sectionId).classList.add('active');
        event.preventDefault();
      }
    });

    window.addEventListener('resize', () => {
      fitGreeting();
      syncTimeWidth();
    });
  </script>
</body>
</html>
